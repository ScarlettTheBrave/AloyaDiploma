"use client";
import { Content, Footer, Header } from "antd/es/layout/layout";
import { Layout,Menu } from "antd";
import Link from "next/link";
import './globals.css'; 
import { useEffect, useState } from "react";
import { GetUser } from "./api/userOp";
import { stringToByteArray, toBase64 } from "./api/photo";
import AvatarWithLoader from "./components/AvatarWithLoad";
import { Popover }from "antd";

const items = [
  {key: "home", label: <a style={{color: 'white',alignItems: 'center'}} href={"/"}>
  <svg style={{width: '5vh', height: '5vh',marginBottom: '-1.5vh'}}  viewBox="0 0 1024 1024" fill="#ffffff"   version="1.1" xmlns="http://www.w3.org/2000/svg">
    <path d="M981.534498 248.354447l-0.403282-2.01641c-0.403282-1.881982-0.940991-3.629537-1.747555-5.511519-0.134427-0.403282-0.268855-0.940991-0.537709-1.344273-0.940991-2.150837-2.01641-4.032819-3.226255-5.914802l-1.075419-1.4787c-1.075418-1.4787-2.150837-2.822973-3.49511-4.167246-0.403282-0.403282-0.806564-0.940991-1.209846-1.344274-1.613128-1.613128-3.360683-3.091828-5.242664-4.436101-0.268855-0.134427-0.672137-0.403282-0.940992-0.537709-1.209846-0.806564-2.419691-1.613128-3.763964-2.285264l-430.167378-215.083689c-11.426321-5.645947-24.734624-5.645947-36.026518 0l-430.167378 215.083689c-1.344273 0.672137-2.554119 1.4787-3.763964 2.285264-0.268855 0.134427-0.672137 0.403282-0.940991 0.537709-1.881982 1.344273-3.629537 2.822973-5.242665 4.436101-0.403282 0.403282-0.806564 0.806564-1.209846 1.344274-1.209846 1.344273-2.419691 2.688546-3.49511 4.167246l-1.075418 1.4787c-1.209846 1.881982-2.285264 3.898392-3.226256 5.914802-0.134427 0.403282-0.268855 0.940991-0.537709 1.344273-0.672137 1.747555-1.209846 3.629537-1.747555 5.511519l-0.403282 2.01641c-0.403282 2.419691-0.672136 4.839383-0.672136 7.259074v512.974598c0 15.324713 8.603348 29.170725 22.314932 36.026518l430.167378 215.083689c0.268855 0.134427 0.672137 0.268855 1.075419 0.403282 1.881982 0.940991 4.032819 1.613128 6.049228 2.150837 0.806564 0.268855 1.4787 0.537709 2.285265 0.672137 2.822973 0.672137 5.780374 1.075418 8.737774 1.075418s5.914801-0.403282 8.737775-1.075418c0.806564-0.134427 1.4787-0.537709 2.285265-0.672137 2.150837-0.537709 4.167246-1.344273 6.049228-2.150837 0.268855-0.134427 0.672137-0.268855 1.075419-0.403282l430.167377-215.083689a40.328192 40.328192 0 0 0 22.314933-36.026518V255.613521c-0.268855-2.419691-0.537709-4.839383-0.940991-7.259074zM511.711065 85.56298L851.677721 255.613521l-123.135412 61.567706-199.08684-97.728651c-0.268855-0.134427-0.672137-0.134427-0.940991-0.268854-1.747555-0.806564-3.629537-1.4787-5.511519-2.01641-0.806564-0.268855-1.613128-0.537709-2.554119-0.806564a45.705284 45.705284 0 0 0-6.183656-0.806564c-0.806564 0-1.613128-0.268855-2.419692-0.268854h-0.268854c-5.780374 0-11.291894 1.209846-16.265704 3.49511-0.134427 0-0.268855 0.134427-0.403282 0.134427L287.351892 313.417263 171.744409 255.613521 511.711065 85.56298z m0 596.453955l-139.132261-69.498917 138.728979-77.967837 136.443715 79.446537L511.711065 682.016935zM688.482972 387.352281v157.14552L552.039257 464.916836V320.407483l136.443715 66.944798zM471.382873 464.513554l-144.509353 81.194093V384.126026L471.382873 318.256646v146.256908zM121.871879 512.10082V320.810765l124.345258 62.239842V614.534427c0 0.672137 0.134427 1.344273 0.268854 2.150837l0.403282 4.301674 0.806564 3.898392c0.268855 1.209846 0.672137 2.419691 1.075418 3.629537 0.537709 1.344273 1.075418 2.688546 1.747555 4.032819 0.268855 0.672137 0.537709 1.209846 0.806564 1.881983 0.134427 0.403282 0.537709 0.537709 0.672137 0.940991 1.613128 2.822973 3.49511 5.377092 5.780374 7.662356l0.403282 0.403282a42.075747 42.075747 0 0 0 9.678766 6.99022c0.537709 0.268855 0.940991 0.537709 1.4787 0.806564 0.403282 0.134427 0.672137 0.403282 0.940991 0.672136L471.382873 752.053561V918.340138l-349.510994-174.755497V512.10082zM901.550251 743.584641l-349.510994 174.755497V752.053561l194.785166-97.325369a40.287863 40.287863 0 0 0 22.180505-38.849492c0-0.403282 0.134427-0.806564 0.134427-1.209845V387.083426L901.550251 320.810765V743.584641z" />
    xmlns=2544
  </svg>
  </a>},
  {key: "student",label: <a style={{fontWeight: 'bold',color: 'white'}} href={"/modules"}>MODULES</a>},
  {key: "teach", label: <Popover style={{fontWeight: 'bold',color: 'white'}}  content={
    <div style={{textAlign: 'center'}}>
      <a href="/modulesmanag" style={{display: 'block'}}>MODULES</a>
      <a href="/testsmanag" style={{display: 'block',left: 'max'}}>TESTS</a>
      <a href="/lectionsmanag" style={{display: 'block'}}>LECTIONS</a>
    </div>}>
    <a>TO MANAGE</a>
  </Popover>},
  {key: "admin", label: <a style={{fontWeight: 'bold',color: 'white'}} href={"foradmin"}>FOR ADMIN</a>},
  {key: "void", label: <div style={{marginLeft: '40rem'}}></div>},
  {key: "ava", label:  <AvatarWithLoader/>},
  {key: "cab", label: <a style={{fontWeight: 'bold', color: 'white'}} href={"/cab"}>CABINET</a>},
  {key: "user", label:  <a style={{fontWeight: 'bold',color: 'white'}}  href={"/user"}>LOGIN/SIGN UP</a>}
  
];


export default function RootLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  const [loading, setLoading] = useState(true);
  const [photoBase64,setPhotoBase64] = useState('');
  useEffect(() => {
    avaGet();
    const timer = setTimeout(() => {
      setLoading(false);
    }, 750);

    return () => clearTimeout(timer);
  }, []);
const avaGet = async () => {
  const userd = await GetUser();
  let byteString = userd.photo;
  let base64string = toBase64(stringToByteArray(byteString));
  setPhotoBase64(base64string || "none.jpg");

}

  return (
    <html lang="en">
      <head>
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap"/>

      </head>
      <body>
      {loading ? (
          <div style={{ width: '100%', height: '130vh', background: 'black', color: 'white', display: 'flex', justifyContent: 'center', alignItems: 'center' }}>

            <svg style={{ marginBottom: '10vh' }} width="20vh" height="30vh" viewBox="0 0 1024 1024"  fill="#1324bf"   version="1.1" xmlns="http://www.w3.org/2000/svg">
          <path style={{ filter: 'drop-shadow(30px 30px 30px rgba(99, 12, 199, 0.7))'}} d="M981.534498 248.354447l-0.403282-2.01641c-0.403282-1.881982-0.940991-3.629537-1.747555-5.511519-0.134427-0.403282-0.268855-0.940991-0.537709-1.344273-0.940991-2.150837-2.01641-4.032819-3.226255-5.914802l-1.075419-1.4787c-1.075418-1.4787-2.150837-2.822973-3.49511-4.167246-0.403282-0.403282-0.806564-0.940991-1.209846-1.344274-1.613128-1.613128-3.360683-3.091828-5.242664-4.436101-0.268855-0.134427-0.672137-0.403282-0.940992-0.537709-1.209846-0.806564-2.419691-1.613128-3.763964-2.285264l-430.167378-215.083689c-11.426321-5.645947-24.734624-5.645947-36.026518 0l-430.167378 215.083689c-1.344273 0.672137-2.554119 1.4787-3.763964 2.285264-0.268855 0.134427-0.672137 0.403282-0.940991 0.537709-1.881982 1.344273-3.629537 2.822973-5.242665 4.436101-0.403282 0.403282-0.806564 0.806564-1.209846 1.344274-1.209846 1.344273-2.419691 2.688546-3.49511 4.167246l-1.075418 1.4787c-1.209846 1.881982-2.285264 3.898392-3.226256 5.914802-0.134427 0.403282-0.268855 0.940991-0.537709 1.344273-0.672137 1.747555-1.209846 3.629537-1.747555 5.511519l-0.403282 2.01641c-0.403282 2.419691-0.672136 4.839383-0.672136 7.259074v512.974598c0 15.324713 8.603348 29.170725 22.314932 36.026518l430.167378 215.083689c0.268855 0.134427 0.672137 0.268855 1.075419 0.403282 1.881982 0.940991 4.032819 1.613128 6.049228 2.150837 0.806564 0.268855 1.4787 0.537709 2.285265 0.672137 2.822973 0.672137 5.780374 1.075418 8.737774 1.075418s5.914801-0.403282 8.737775-1.075418c0.806564-0.134427 1.4787-0.537709 2.285265-0.672137 2.150837-0.537709 4.167246-1.344273 6.049228-2.150837 0.268855-0.134427 0.672137-0.268855 1.075419-0.403282l430.167377-215.083689a40.328192 40.328192 0 0 0 22.314933-36.026518V255.613521c-0.268855-2.419691-0.537709-4.839383-0.940991-7.259074zM511.711065 85.56298L851.677721 255.613521l-123.135412 61.567706-199.08684-97.728651c-0.268855-0.134427-0.672137-0.134427-0.940991-0.268854-1.747555-0.806564-3.629537-1.4787-5.511519-2.01641-0.806564-0.268855-1.613128-0.537709-2.554119-0.806564a45.705284 45.705284 0 0 0-6.183656-0.806564c-0.806564 0-1.613128-0.268855-2.419692-0.268854h-0.268854c-5.780374 0-11.291894 1.209846-16.265704 3.49511-0.134427 0-0.268855 0.134427-0.403282 0.134427L287.351892 313.417263 171.744409 255.613521 511.711065 85.56298z m0 596.453955l-139.132261-69.498917 138.728979-77.967837 136.443715 79.446537L511.711065 682.016935zM688.482972 387.352281v157.14552L552.039257 464.916836V320.407483l136.443715 66.944798zM471.382873 464.513554l-144.509353 81.194093V384.126026L471.382873 318.256646v146.256908zM121.871879 512.10082V320.810765l124.345258 62.239842V614.534427c0 0.672137 0.134427 1.344273 0.268854 2.150837l0.403282 4.301674 0.806564 3.898392c0.268855 1.209846 0.672137 2.419691 1.075418 3.629537 0.537709 1.344273 1.075418 2.688546 1.747555 4.032819 0.268855 0.672137 0.537709 1.209846 0.806564 1.881983 0.134427 0.403282 0.537709 0.537709 0.672137 0.940991 1.613128 2.822973 3.49511 5.377092 5.780374 7.662356l0.403282 0.403282a42.075747 42.075747 0 0 0 9.678766 6.99022c0.537709 0.268855 0.940991 0.537709 1.4787 0.806564 0.403282 0.134427 0.672137 0.403282 0.940991 0.672136L471.382873 752.053561V918.340138l-349.510994-174.755497V512.10082zM901.550251 743.584641l-349.510994 174.755497V752.053561l194.785166-97.325369a40.287863 40.287863 0 0 0 22.180505-38.849492c0-0.403282 0.134427-0.806564 0.134427-1.209845V387.083426L901.550251 320.810765V743.584641z">
          <animate attributeName="filter" from="#1324bf" to="#bf134f" dur="0.5s" repeatCount="indefinite" />
          </path>
          xmlns=2544
          <animate attributeName="fill" from="#1324bf" to="#1eeb1e" dur="0.5s" repeatCount="indefinite" />
            </svg>
          </div>
        ) : (
          
        <Layout style={{minHeight: "100vh"}}>
         <Header style={{background: '#141414', justifyContent: 'center', alignItems: 'center', position: 'fixed', width: '100%', zIndex: 1000}}>
          <Menu
            theme="dark"
            mode="horizontal"
            items={items}
            style={{background: '#141414', textAlign: 'center', flex: 2, minWidth: 0}}
          />
        </Header>
          <Content style={{ background: 'white',padding: "0 40px",marginTop: '50px'}}>
            {children}
          </Content>
          <Footer style={{background: "#141414", textAlign: 'center', color: '#ffffff'}}>
          <svg style={{ alignSelf: 'center', marginBottom: '-0.7vh', marginRight: '1vh' }}  width="3vh" height="3vh" viewBox="0 0 1024 1024" fill="#ffffff"   version="1.1" xmlns="http://www.w3.org/2000/svg">
            <path d="M981.534498 248.354447l-0.403282-2.01641c-0.403282-1.881982-0.940991-3.629537-1.747555-5.511519-0.134427-0.403282-0.268855-0.940991-0.537709-1.344273-0.940991-2.150837-2.01641-4.032819-3.226255-5.914802l-1.075419-1.4787c-1.075418-1.4787-2.150837-2.822973-3.49511-4.167246-0.403282-0.403282-0.806564-0.940991-1.209846-1.344274-1.613128-1.613128-3.360683-3.091828-5.242664-4.436101-0.268855-0.134427-0.672137-0.403282-0.940992-0.537709-1.209846-0.806564-2.419691-1.613128-3.763964-2.285264l-430.167378-215.083689c-11.426321-5.645947-24.734624-5.645947-36.026518 0l-430.167378 215.083689c-1.344273 0.672137-2.554119 1.4787-3.763964 2.285264-0.268855 0.134427-0.672137 0.403282-0.940991 0.537709-1.881982 1.344273-3.629537 2.822973-5.242665 4.436101-0.403282 0.403282-0.806564 0.806564-1.209846 1.344274-1.209846 1.344273-2.419691 2.688546-3.49511 4.167246l-1.075418 1.4787c-1.209846 1.881982-2.285264 3.898392-3.226256 5.914802-0.134427 0.403282-0.268855 0.940991-0.537709 1.344273-0.672137 1.747555-1.209846 3.629537-1.747555 5.511519l-0.403282 2.01641c-0.403282 2.419691-0.672136 4.839383-0.672136 7.259074v512.974598c0 15.324713 8.603348 29.170725 22.314932 36.026518l430.167378 215.083689c0.268855 0.134427 0.672137 0.268855 1.075419 0.403282 1.881982 0.940991 4.032819 1.613128 6.049228 2.150837 0.806564 0.268855 1.4787 0.537709 2.285265 0.672137 2.822973 0.672137 5.780374 1.075418 8.737774 1.075418s5.914801-0.403282 8.737775-1.075418c0.806564-0.134427 1.4787-0.537709 2.285265-0.672137 2.150837-0.537709 4.167246-1.344273 6.049228-2.150837 0.268855-0.134427 0.672137-0.268855 1.075419-0.403282l430.167377-215.083689a40.328192 40.328192 0 0 0 22.314933-36.026518V255.613521c-0.268855-2.419691-0.537709-4.839383-0.940991-7.259074zM511.711065 85.56298L851.677721 255.613521l-123.135412 61.567706-199.08684-97.728651c-0.268855-0.134427-0.672137-0.134427-0.940991-0.268854-1.747555-0.806564-3.629537-1.4787-5.511519-2.01641-0.806564-0.268855-1.613128-0.537709-2.554119-0.806564a45.705284 45.705284 0 0 0-6.183656-0.806564c-0.806564 0-1.613128-0.268855-2.419692-0.268854h-0.268854c-5.780374 0-11.291894 1.209846-16.265704 3.49511-0.134427 0-0.268855 0.134427-0.403282 0.134427L287.351892 313.417263 171.744409 255.613521 511.711065 85.56298z m0 596.453955l-139.132261-69.498917 138.728979-77.967837 136.443715 79.446537L511.711065 682.016935zM688.482972 387.352281v157.14552L552.039257 464.916836V320.407483l136.443715 66.944798zM471.382873 464.513554l-144.509353 81.194093V384.126026L471.382873 318.256646v146.256908zM121.871879 512.10082V320.810765l124.345258 62.239842V614.534427c0 0.672137 0.134427 1.344273 0.268854 2.150837l0.403282 4.301674 0.806564 3.898392c0.268855 1.209846 0.672137 2.419691 1.075418 3.629537 0.537709 1.344273 1.075418 2.688546 1.747555 4.032819 0.268855 0.672137 0.537709 1.209846 0.806564 1.881983 0.134427 0.403282 0.537709 0.537709 0.672137 0.940991 1.613128 2.822973 3.49511 5.377092 5.780374 7.662356l0.403282 0.403282a42.075747 42.075747 0 0 0 9.678766 6.99022c0.537709 0.268855 0.940991 0.537709 1.4787 0.806564 0.403282 0.134427 0.672137 0.403282 0.940991 0.672136L471.382873 752.053561V918.340138l-349.510994-174.755497V512.10082zM901.550251 743.584641l-349.510994 174.755497V752.053561l194.785166-97.325369a40.287863 40.287863 0 0 0 22.180505-38.849492c0-0.403282 0.134427-0.806564 0.134427-1.209845V387.083426L901.550251 320.810765V743.584641z" />
            xmlns=2544
          </svg>
            <a>Aloya 2023 Created by Artem Marikov</a>
          </Footer>
        </Layout>
         )}
      </body>
    </html>
  );
}
